# 创建账户

您可以随意注册离线密钥对（包含地址和私钥），但是这个密钥对不会被TRON网络记录。
要想使这个密钥对成为TRON网络中的账户，需要其他已经存在于TRON网络的账户调用以下3种api之一：
- 直接调用创建账户api
- 给新地址转TRX
- 给新地址转任意一种token

交易被网络确认后，您就可以在TRON网络中查询到地址对应的账户的信息了。创建账户会烧掉创建者的0.1TRX，但交易本身不消耗bandwidth。
 
# 超级代表

## 在波场TRON社区的持币者当中，将存在如下角色：

1.	持币者，即持有任何数量TRX的个体
2.	代表，由全体持币者投票选择的个体，票数最高的127名作为代表，每6小时统计一次票数
3.	超级代表，127名代表中票数最高的27名作为超级代表。超级代表是波场TRON社区的核心治理者，他们将实现波场TRON网络的出块、记账等基础功能，并获取对应收益。

## 奖励

1. 代表奖励，每6小时，票数排名前127名的代表会获得共计115,200 TRX的代表奖励，这部分奖励将按照票数比例分发。每年总计168,192,000 TRX将会被奖励给代表。

2. 超级代表奖励，波场协议网络每3秒中会出一个区块，每个区块将给予超级代表32个TRX奖励，每年总计336,384,000 TRX将会被奖励给超级代表。

+ 超级代表每次出块完成后，出块奖励都会发到超级账本的子账号当中，超级代表不能直接使用这部分资产，但可以查询。 每24h允许一次提取操作。从该子账号转移到超级代表的账户中。
+ 2021年1月1日前的所有出块奖励和代表奖励都将由波场基金会承担，波场网络不会有任何增发。

    
## 超级代表的信息

+ 超级代表的信息是在TRON网络上公开的，所有人都可以获取这些信息，用户可以通过TRON区块链浏览器查看关于超级代表节点的具体信息。详细信息显示如下：

   + 超级节点的账户地址。
   + 该超级节点所获得的投票数。
   + 个人网站的url链接。
   + 该超级节点的总出块数。
   + 该超级节点的总丢失块数。
   + 上一个区块高度。

## 申请成为超级代表规则

任何账户都可以申请成为超级代表账户。但是为了防止恶意攻击，这也是需要一定代价的。TRON网络将直接烧掉申请者账户9999TRX。申请成功后，申请者就成为超级代表候选人，可以竞选超级代表了。

# 冻结/解冻资金

## 为什么要冻结资金

设置冻结资金的机制有2个出发点：
+ 防止恶意的垃圾交易阻塞网络，造成交易确认缓慢的问题
+ 防止恶意投票

## 冻结/解冻机制

冻结资金后，你将获得对应数量的TRON Power(TP)、Bandwidth Points和CPU资源。   
**注意** 冻结时需要指定获取Bandwidth或CPU其中的一种，默认为Bandwidth
TRON Power(TP)可以用来投票，bandwidth points和CPU用于交易。TRON Power(TP)及bandwidth points、CPU的使用及计算规则在后文中介绍。

冻结的资金会进入你的冻结账户，无法用于交易，冻结时间固定为3天。

当临时需要更多的TRON Power(TP)或bandwidth时，可以追加冻结资金，从而获取追加部分的TRON Power(TP)与bandwidth。此时解冻时间推迟到最后一次冻结操作的3天后。

+ 冻结命令如下：

```
freezebalance password amount time
amount:冻结资金，单位是sun。amount最小为 1,000,000 sun, 即1TRX
time：冻结时间，冻结资金到解冻资金的时间为3天。
```

+ 示例：

    `freezebalance password 10_000_000 3`

+ 解冻命令如下：

    `unfreezebalance password`

# 投票

TRON网络中的每一个账户都具有选举权，可以通过投票选出自己认同的超级代表。 投票需要TRON Power(TP)，你的TRON Power(TP)的多少由当前冻结资金决定。

TRON Power(TP)的计算方法：每冻结1TRX，就可以获得1单位TRON Power(TP)。

在解冻后，你没有了冻结的资产，相应地失去了所有的TRON Power(TP)，因此以前的投票会失效。你可以通过重新冻结并投票来避免投票失效。

注意: 波场网络只记录你最后一次投票的状态，也就是说你的每一次投票都会覆盖以前所有的投票效果

+ 示例：

```
freezebalance password 10,000,000 3 // 冻结了10TRX，获取了10单位TRON Power(TP)
votewitness password witness1 4 witness2 6 // 同时给witness1投了4票，给witness2投了6票
votewitness password witness1 3 witness2 7 // 同时给witness1投了3票，给witness2投了7票
```

以上命令的最终结果是给witness1投了3票，给witness2投了7票

# 资源
波场网络的交易分为两种：系统合约与智能合约。系统合约包括转账、冻结、投票等常用操作。智能合约由波场虚拟机（TVM）提供。    
波场网络存在3种资源，包含Bandwidth，CPU，RAM。其中bandwidth会在所有交易中消耗，CPU与RAM只在智能合约调用中消耗。
只有拥有足够的资源，一个账户才能发起交易和调用智能合约。

## 一、Bandwidth资源

过多的无关紧要的交易会造成类似于以太坊的网络拥堵，从而使得交易确认时间延迟。 为了避免阻塞网络，TRON网络允许每个账户免费发起限量的交易，更高的交易频率则需要消耗bandwidth points。bandwidth points和TRON Power(TP)一样，通过冻结资金来获取。

### 1、Bandwidth Points的定义
交易以字节数组的形式在网络中传输及存储，一条交易消耗的Bandwidth Points就是在这个交易的字节数组的大小。

如一条交易的字节数组长度为200，那么该交易需要消耗200 Bandwidth Points。

### 2、Bandwidth Points的计算规则
Bandwidth Points是一个账户1天内能够使用的总字节数。一定时间内，整个网络能够处理的Bandwidth为确定值。
一个账户的Bandwidth Points与TRON网络的总Bandwidth的比值等于该账户的冻结资金与TRON网络总冻结资金的比值。
例如，假设当前网络中总冻结资金为100亿TRX，一个账户冻结了10000TRX，占总冻结资金的百万分之一，每天可以执行约300条交易。

**注意** 
- 由于网络中总冻结资金以及账户的冻结资金随时可能发生变化，因此账户拥有的Bandwidth Points不是固定值。
- 消耗掉的Bandwidth会在一天内恢复。

### 3、免费的Bandwidth Points
每个账户每天有5000字节的免费Bandwidth Points。当一个账户没有冻结资产或者冻结资产获取的Bandwidth Points被用完时，会使用免费的Bandwidth Points。
TRON网络中每条交易大小约为200字节，因此每个账户每天可以免费交易大约25次。

### 4、token转账相关
如果交易类型是token的转账，交易会先尝试消耗token发行者的Bandwidth Points。

token发行者在发行token时，可以配置Bandwidth Points消耗限制参数，即每个拥有该token的账户在24h内token转账可以消耗的最大Bandwidth Points，以及总的最大Bandwidth Points。

这两个参数都可以通过updateAsset接口更改。

### 5、Bandwidth Points的消耗规则
除了查询操作，任何交易都需要消耗bandwidth points。一条交易的带宽消耗流程如下：

    1、如果不是token转账，则进入第2步；否则尝试消耗token发行者的Bandwidth Points，如果发行者Bandwidth Points不足或超过设定的最大值，则进入第2步。

    2、尝试消耗交易发起者冻结获取的Bandwidth Points。如果交易发起者Bandwidth Points不足：
       (1) 如果该交易会创建一个新账户，则进入第4步；
       (2) 如果该交易不会创建新账户，则进入第3步。
    
    3、尝试消耗交易发起者的免费Bandwidth Points。如果免费Bandwidth Points也不足，则进入第4步。
    
    4、尝试消耗交易发起者的TRX，这部分TRX会烧掉。
       (1) 如果是普通转账，则烧掉大约0.002TRX；
       (2) 如果该交易会创建新账户，则烧掉0.1TRX。
    

**注意** 发生解冻操作时，由于没有冻结资产，bandwidth points也会清空。

      
直接调用创建账户api、转移资产、转移token都允许创建账户。

## 二、CPU资源

### 1、CPU资源的定义
CPU资源：调用智能合约在虚拟机执行过程中消耗的CPU时间，单位为微秒。

如一条合约在虚拟机中执行花费100微秒，即需要消耗100微秒的CPU资源。

### 2、CPU资源的计算规则
CPU资源的计算规则与Bandwidth类似。 
CPU_Limit 是一个账户1天内拥有的合约执行时间。系统合约不消耗CPU资源。
24小时内，整个网络提供的执行时间为确定值。一个账户的 CPU_Limit 与TRON网络的总CPU资源的比值等于该账户的冻结量(CPU)与TRON网络总冻结量(CPU)的比值。    
注意，冻结资金获得bandwidth与获得cpu是独立的两个操作，即如果指定冻结TRX获得bandwidth，CPU资源不会变化。    
例如，假设当前网络中总冻结量（CPU）为1000_000_000TRX，CPU总量为32400_000_000微秒，一个账户冻结了1000TRX，占总冻结量的百万分之一，即32400微秒。    
一条合约执行如果需要花费324微秒，那么用户可以触发100次该合约。

**注意** 
- 由于网络中总冻结量以及账户的冻结量随时可能发生变化，因此账户拥有的CPU资源不是固定值。    
- 消耗掉的Bandwidth会在一天内恢复。

## 三、RAM

### 1、RAM资源的定义
RAM资源：调用智能合约在虚拟机执行过程中消耗的存储资源，即合约执行前后数据库的变化情况，单位为字节。

### 2、RAM资源市场
RAM资源采用bancor协议，用户可以通过向系统账户购买/出售该资源。  
波场网络的RAM资源总量初始为 274_877_906_944字节(256GB)。建议每年增发30%（需委员会投票同意）。

## 四、智能合约的调用者与开发者分摊资源的消耗
智能合约的开发者可以指定资源消耗比例。当调用者调用智能合约时，调用者和发起者按照比例消耗资源。当发起者资源不足时，该部分由调用者负担。  
例如一个智能合约的开发者指定比例为80:20，即开发者负责80%的CPU和Storage资源消耗，调用者负责剩下的20%。
当一个账户调用该智能合约时，假设消耗了100us的CPU，则开发者负责80us，调用者负责20us。

## 五、资源不足时扣除TRX
一次智能合约的调用会消耗CPU和RAM资源，当这两种资源有1种或2种不足时，则会自动扣除调用者的TRX。

### 1) CPU的扣费
优先使用账户通过冻结获取的CPU资源，当不足时，按照每微秒30sun扣除TRX。

### 2) RAM的扣费
RAM的扣费实际上是"代购"，即用账户的TRX代为购买RAM，这部分RAM既可以使用也可以之后再卖出。

### 3) 资源消耗的上限
合约调用者可以通过设置TRX_limit参数来限定消耗的资源和TRX上限。这个上限有一个默认值，调用者也可以手动设置上限。  
需要注意的是，TRX_limit不只限制了资源不足时扣除TRX的上限，还限制了CPU和RAM使用量的上限（即使这两种资源都充足）。
具体来说，虚拟机会根据每微秒30sun以及当前RAM市场的实时价格分别把CPU和RAM资源折合成TRX，当虚拟机执行消耗掉超过等价TRX的CPU或RAM时，就会自动停止（即使你拥有的CPU和RAM充足）。

# 发行资产

在TRON网络，每个账户都可以轻松便捷地发行资产，会消耗1024TRX。发行资产的时候可以对多笔资产锁仓。
发行资产的时候需要指定token名称、发行总量、兑换比例、发行日期、描述、网址、每账户最多消耗带宽值，总带宽消耗值以及token冻结资产。

+ 示例：

`assetissue password abc 1000000 1 1 2018-5-31 2018-6-30 abcdef a.com 1000 1000000 200000 180 300000 365` 

以上命令的发行了名为abc的资产，发行总量为100万，abc与TRX的兑换比例为1:1，发行日期为2018-5-31至2018-6-30，描述为abcdef，网址为a.com，
每个账户每天的token转账最多消耗自己1000 bandwidth points，整个网络每天最多消耗自己1000000 bandwidth points。其中20万锁仓180天，30万锁仓365天。

### 1、重名资产问题

允许资产名称相同。相同名称的两个资产，通过order字段区别，第一个创建的资产的order为0，第二个资产的order为1， 以此类推。
+ 示例：(部分字段省略)

    
    Asset {   
      name = aaa;   
      order = 0; 
      owner_address = address1; 
     } 
     
    Asset2 {   
      name = aaa;   
      order = 1; 
      owner_address = address2; 
     } 
     
    Account {   
      asset[
      {
       asset_name = aaa;   
       amount = 100; 
      },
      {
       asset_name = aaa_1;   
       amount = 100; 
      }
     } 

网络中有两个名称都为aaa的asset，第一个order为0，第二个order为1。

一个账户拥有这两个资产，资产的名称分别为aaa与aaa_1。

参与资产时（使用ParticipateAssetIssue api），如果参与的资产是第二个资产，输入参数需要是aaa_1。
同理，转移资产时（使用TransferAsset api），如果参与的资产是第二个资产，输入参数也需要是aaa_1。
查询资产时（使用GetAssetIssueByName api),如果参与的资产是第二个资产，输入参数也需要是aaa_1。

如果网络中不存在名称相同的asset，不用考虑order的影响。

 
# 委员会

### 什么是委员会
委员会用于修改Tron网络动态参数，如出块奖励、交易费用等等。委员会由当前的27个超级节点组成。每个超级节点都具有提议权、对提议的投票权，
当提议获得18个节点及以上的赞成票时，该提议获得通过，并在下个维护期内进行网络参数修改。

### 创建提议
只有超级节点对应账户具有提议权，其他账户无法创建提议。允许修改的网络动态参数以及编号如下( [min,max] )：
- 0: MAINTENANCE_TIME_INTERVAL, [3 * 27* 1000 ,24 * 3600 * 1000] //ms
- 1: ACCOUNT_UPGRADE_COST, [0,100 000 000 000 000 000]  //sun
- 2: CREATE_ACCOUNT_FEE, [0,100 000 000 000  000 000] //sun
- 3: TRANSACTION_FEE, [0,100 000 000 000 000 000] //sun
- 4: ASSET_ISSUE_FEE, [0,100 000 000 000 000 000] //sun
- 5: WITNESS_PAY_PER_BLOCK, [0,100 000 000 000 000 000] //sun
- 6: WITNESS_STANDBY_ALLOWANCE, [0,100 000 000 000 000 000] //sun
- 7: CREATE_NEW_ACCOUNT_FEE_IN_SYSTEM_CONTRACT, //sun 
- 8: CREATE_NEW_ACCOUNT_BANDWIDTH_RATE, // 提议7、8，组合使用，用于修改创建账户时对资源或TRX的消耗。详见委员会提议清单。
- 9: ALLOW_CREATION_OF_CONTRACTS, // 用于控制虚拟机功能的开启。详见委员会提议清单。
- 10: REMOVE_THE_POWER_OF_THE_GR  // 用于清楚GR的默认投票信息。详见委员会提议清单。

+ API：
`
createproposal id0 value0 ... idN valueN
id0_N: 参数编号
value0_N: 新参数值
`

### 对提议进行投票
提议仅支持投赞成票，不投票代表不赞同。从提议创建时间开始，3天时间内为提议的有效期。超过该时间范围，该提议如果没有获得足够的
赞成票，该提议失效。允许取消之前投的赞成票。


+ API：
`
approveProposal id is_or_not_add_approval
id: 提议Id，根据提议创建时间递增
is_or_not_add_approval: 赞成或取消赞成
`

### 取消提议
提议创建者，能够在提议生效前，取消提议。

+ API：
`
deleteProposal proposalId
id: 提议Id，根据提议创建时间递增
`

# 去中心化交易所
##1、什么是交易对（Exchange）
TRON网络原生支持去中心化交易所。去中心化交易所由多个交易对构成。一个交易对（Exchange）是token与token之间，或者token与TRX之间的交易市场（Exchange Market）。
任何账户都可以创建任何token之间的交易对，即使TRON网络中已经存在相同的交易对。交易对的买卖与价格波动遵循Bancor协议。
TRON网络规定，所有交易对中的两个token的权重相等，因此它们数量（balance）的比率即是它们之间的价格。
举一个简单的例子，假设一个交易对包含ABC和DEF两种token，ABC的balance为1000万，DEF的balance为100万，由于权重相等，因此10 ABC = 1 DEF，也就是说，当前ABC对于DEF的价格为10ABC/DEF。

##2、创建交易对
任何账户都可以创建任何token之间的交易对。创建交易对的手续费是1024TRX，这个手续费会被TRON网络烧掉。   
创建交易对相当于为该交易对注入（inject）原始资本，因此创建者账户中要拥有该交易对的初始balance。当创建成功后，会立即从创建者账户中扣除这两个token的balance。   
创建交易对的合约是ExchangeCreateContract，该合约有4个参数：
	- first_token_id，第1种token的id   
	- int64 first_token_balance，第1种token的balance   
	- bytes second_token_id，第2种token的id   
	- int64 second_token_balance，第2种token的balance   

其中token的id的概念请参加token发行相关部分的文档。如果交易对中包含TRX，则使用"_"表示TRX的id。需要注意的是，TRX的单位是sun，即10-6 TRX。    
例子：
`    
ExchangeCreate abc 10000000 _ 1000000000000    
`
该交易会创建abc与TRX之间的交易对，初始balance分别为10000000个abc和1000000000000 sun（1000000TRX），
如果创建者没有足够的abc和TRX，则交易对创建失败；否则创建者账户中立即扣除相应的abc和TRX，交易对创建成功，可以开始交易。     

##3、交易（Transaction）
任何账户都可以在任何交易对中进行交易。交易量和价格完全遵循Bancor协议。也就是说，一个账户在交易时，交易的对象是exchange。交易是即时的，不需要挂单和抢单，只要有足够的token，就可以交易成功。     
交易的合约是ExchangeTransactionContract，该合约有3个参数：     
	- exchange_id，交易对的id
	- token_id，要卖出的token的id
	- quant，要卖出的token的金额

例子：       
我们在刚刚创建的abc与TRX的交易对中进行交易，假设此交易对id为1，当前交易对中abc balance为10000000，TRX balance为1000000，如果要花100个TRX买abc，则      
`  
ExchangeTransaction 1 _ 100  
`     
其中"_"表示TRX，即向交易对卖出100个TRX。如果成功，该交易会使得交易对中增加100个TRX，并根据Bancor协议计算出减少的abc的数量，交易对创建者的账户中abc和TRX的数量会相应地增加和减少。


##4、注资（Inject）
当一个交易对其中1种token的balance很小时，只需要很小的交易量就会造成很大的价格波动，这不利于正常交易。为了避免这种情况，该交易对的创建者可以选择向该交易对注资（inject）。
一个交易对只能由该交易对的创建者来注资。注资不需要手续费。    
注资需要指定一种token以及注资金额，TRON网络会自动根据当前交易对中两种token的比例，计算出另一个token所需的金额，从而保证注资前后，交易对中两个token的比例相同，价格没有变化。    
与创建交易对相同，注资要求创建者拥有足够多的两种token的balance。    
注资的合约是ExchangeInjectContract，该合约有3个参数：    
	- exchange_id，交易对的id，TRON网络会根据交易对创建时间顺序给每个交易对唯一的id
	- token_id，要注资的token的id
	- quant，要注资的token的金额

例子：    
我们对刚刚创建的abc与TRX的交易对进行注资，假设此交易对id为1（TRON网络中第1个交易对），当前交易对中abc balance为10000000，TRX balance为1000000，如果要增加10%的abc，则
`
ExchangeInject 1 abc 1000000
`    
如果成功，该交易会使得交易对中增加1000000个abc，并增加100000个TRX，交易对创建者的账户中abc和TRX的数量会相应地减少。

##5、撤资（withdraw）
一个交易对中的所有资产都是创建者的。创建者可以随时撤资（withdraw），把交易对中的token赎回到自身账户中。一个交易对只能由该交易对的创建者来撤资。撤资不需要手续费。    
和注资一样，撤资需要指定一种token以及撤资金额，TRON网络会自动根据当前交易对中两种token的比例，计算出另一个token撤资的金额，从而保证撤资前后，交易对中两个token的比例相同，价格没有变化。    
【风险提示】撤资前后价格没有变化，但是价格波动会更大    
撤资的合约是ExchangeWithdrawContract，该合约有3个参数：    
	- exchange_id，交易对的id
	- token_id，要撤资的token的id
	- quant，要撤资的token的金额

例子：    
我们对之前创建的abc与TRX的交易对进行撤资，假设此交易对id为1，当前交易对中abc balance为10000000，TRX balance为1000000，如果要赎回10%的abc，则    
`
ExchangeWithdraw 1 abc 1000000
`    
如果成功，该交易会使得交易对中减少1000000个abc，以及减少100000个TRX，交易对创建者的账户中abc和TRX的数量会相应地增加。

